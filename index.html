<!doctype html>
<html>
  <head>
    <title>IsoCanvas</title>
    <meta charset="utf-8" />
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      
      body {
        background: #eee;
        padding: 1em;
      }
      
      #c {
        background: #000;
      }
      
      #r {
        float: left;
      }
    </style>
   <!-- <script src="easel.js"></script> -->
  </head>
  <body>
    <canvas id="c" width="1024" height="600"></canvas>
    <div id=resources>
      <img id=rock src="">
    </div>
    <p id="r">360</p>
  </body>
  <!-- EaselJS -->
  <script src="lib/easeljs/utils/UID.js"></script>
  <script src="lib/easeljs/geom/Matrix2D.js"></script>
  <script src="lib/easeljs/geom/Rectangle.js"></script>
  <script src="lib/easeljs/events/MouseEvent.js"></script>
  <script src="lib/easeljs/utils/SpriteSheetUtils.js"></script>
  <script src="lib/easeljs/display/SpriteSheet.js"></script>
  <script src="lib/easeljs/display/DisplayObject.js"></script>
  <script src="lib/easeljs/display/Container.js"></script>
  <script src="lib/easeljs/display/Stage.js"></script>
  <script src="lib/easeljs/display/BitmapAnimation.js"></script>
  <script src="lib/easeljs/display/Bitmap.js"></script>
  <script src="lib/easeljs/display/Text.js"></script>
  <script src="lib/easeljs/display/Graphics.js"></script>
  <script src="lib/easeljs/display/Shape.js"></script>
  <script src="lib/easeljs/utils/Ticker.js"></script>-->

  <!-- topdown -->
  <script src="vector.js"></script>
  <script src="utils.js"></script>
  <script src="world.js"></script>
  <script src="keyboard.js"></script>

<script>
  var canvas = document.getElementById('c')
  var stage = new Stage(canvas)
  stage.addChild(stage.ground = new Container())
  stage.addChild(stage.actors = new Container())
  stage.addChild(stage.info = new Container())
  var lastTick = Date.now()
  var expSheet = new SpriteSheet({
        images: ['images/explosion_sheet.png'],
        frames: {width: 60, height: 60, regX: 30, regY: 30, count: 25},
        animations: {
          explode: [0,25, false]
        }
      })

</script>

  <!-- game objects -->
  <script src="missile.js"></script>
  <script src="tank.js"></script>
  <script src="rock.js"></script>  
  
  <!---->

  <script>
  init()
  function init () {
    
    var schema1 = {
        '38': 'forward',
        '40': 'reverse',
        '37': 'left',
        '39': 'right',
        '86': 'rLeft',
        '90': 'rRight',
        '87': 'fire'
    }
    var schema2 = {
        '80': 'forward',
        '85': 'reverse',
        '69': 'left',
        '73': 'right',
        '188': 'rLeft',
        '190': 'rRight',
        '186': 'fire'
    }
    var pairs = {
      'left,right'      : 'turn',
      'forward,reverse' : 'accelerate',
      'rLeft,rRight'    : 'rotate'
    }
    var p1 = createPlayer('green', v(924,300))
    var p2 = createPlayer('brown', v(100,100))
    var text = new Text('Player_1 : 01', '36px courier', Graphics.getRGB( 0, 255, 0 ))
    text.x = 50
    text.y = 50
    stage.info.addChild(text)

    var l = 20
    while (l--) { world.add(createRock()) }

    world.add(p1).add(p2)

    var p1h = createKBHandler (schema1, pairs, p1)
    var p2h = createKBHandler (schema2, pairs, p2)
    
    window.onkeyup = window.onkeydown = createListener([p1h, p2h])

    function image(id) {
      return document.getElementById(id)
    }
    
    stage.update()
  }
  function tick () {
    world.tick()
  }

  Ticker.setFPS( 40 );
  Ticker.addListener( this );

  </script>
</html>
