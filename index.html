<!doctype html>
<html>
  <head>
    <title>IsoCanvas</title>
    <meta charset="utf-8" />
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      
      body {
        background: #eee;
        padding: 1em;
      }
      
      #c {
        background: #000;
      }
      
      #r {
        float: left;
      }
    </style>
    <script src="easel.js"></script>
  </head>
  <body>
    <canvas id="c" width="1024" height="600"></canvas>
    <div id=resources>
      <img id=hull1 src="images/hull_sprite_larger2.png">
      <img id=turret1 src="images/turret_sprite1.png">
      <img id=turret1_flash src="images/turret_sprite_flash1.png">
      <img id=hull2 src="images/hull_sprite_brown.png">
      <img id=turret2 src="images/turret_sprite_brown1.png">
      <img id=rock src="images/rock_sprite1.png">
    </div>
    <p id="r">360</p>
  </body>
  <script src="utils.js"></script>
  <script src="keyboard.js"></script>
  <script src="tank.js"></script>
  <script src="rock.js"></script>
  <script src="world.js"></script>
  <script>
    var canvas = document.getElementById('c');
    var stage = new Stage(canvas);
    var lastTick = Date.now()

  var schema1 = {
      '38': 'forward',
      '40': 'reverse',
      '37': 'left',
      '39': 'right',
      '86': 'rLeft',
      '90': 'rRight',
      '87': 'fire'
  }
  var schema2 = {
      '80': 'forward',
      '85': 'reverse',
      '69': 'left',
      '73': 'right',
      '188': 'rLeft',
      '190': 'rRight',
      '186': 'fire'
  }
  var pairs = {
    'left,right'      : 'turn',
    'forward,reverse' : 'accelerate',
    'rLeft,rRight'    : 'rotate'
  }
  var p1 = createPlayer('player1', [924,300])
  var p2 = createPlayer('player2', [100,100])
  var things = [p1, p2]

  var l = 20
  while (l--) {
    var rock = createRock()
    drawRock(rock)
    things.push(rock)
  }
  var p1h = createKBHandler (schema1, pairs, p1)
  var p2h = createKBHandler (schema2, pairs, p2)
    
  window.onkeyup = window.onkeydown = createListener([p1h, p2h])
    //createKBHandler (schema, pairs, p2)
    //createKBHandler (schema, pairs, p2)

  function image(id) {
    return document.getElementById(id)
  }

  drawPlayer(p2, {hull: image('hull1'), turret: image('turret1'), flash: image('turret1_flash')})
  drawPlayer(p1, {hull: image('hull2'), turret: image('turret1'), flash: image('turret1_flash')})

  stage.update()




  </script>
</html>